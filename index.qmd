---
title: "Getting Started"
format: 
  html:
     code-fold: true
     code-summary: "Show the code"
bibliography: packages.bib
---

These web pages compliment the *data science* chapters of the forthcoming BCT Bat Survey Guidelines 4^th^ Edition, and hopefully encourage ecologists to make the most of their bat survey data. They also demonstrate literate programming with Quarto®[^1] which can vastly improve workflow (*welcome to the world beyond Excel*).

[^1]: Quarto® is an open-source scientific and technical publishing system: see <https://quarto.org/>

***Note: pages are under active construction*** (so many things won't look right!)

![](Images/homesunrise2.png)

To help ecologists get started, the code making all the graphs and analysis is freely available to copy and use; just click on  _Show the code_, copy to the clipboard [^2], paste into the R environment and run (to get going in R - see the Install R... section below). 

[^2]: Clip board icon is in the top right hand corner of the code window.

A _Show the code_ is given below, the code produces @fig-example.  The code copied to the clipboard is designed to run as a standalone _chunk_; with all the R libraries, data and code.

```{r}
#| code-fold: show
#| label: fig-example
#| fig-cap: "Example Graph: Monthly Bat Activity from the statics data set in the iBats Package"
#| warning: false
#| fig.height: 7

### Libraries Used
library(tidyverse) # Data Science packages - see https://www.tidyverse.org/
library(treemapify) # extension to ggplot for plotting treemaps -
# see https://cran.r-project.org/web/packages/treemapify/vignettes/introduction-to-treemapify.html
library(ggthemes) # for colour pallet "Tableau 10"

# Install devtools if not installed
# devtools is used to install the iBats package from GitHub
if (!require(devtools)) {
  install.packages("devtools")
}

# If iBats not installed load from Github
if (!require(iBats)) {
  devtools::install_github("Nattereri/iBats")
}
library(iBats)
###

# Add data and time information to the iBats statics bat survey data set using the iBats::date_time_info
statics_plus <- iBats::date_time_info(statics)

graph_data <- statics_plus %>%
  group_by(Species, Month) %>%
  tally()

ggplot(graph_data, aes(area = n, fill = Month, label = Species, subgroup = Month)) +
  scale_fill_tableau(palette = "Tableau 10") + #
  geom_treemap(colour = "white", size = 2, alpha = 0.9) +
  geom_treemap_subgroup_border(colour = "black", size = 5, alpha = 0.9) +
  geom_treemap_subgroup_text(place = "centre", grow = T, alpha = 0.9, colour = "grey20", min.size = 0) +
  geom_treemap_text(colour = "grey90", place = "topleft", fontface = "italic", reflow = T, min.size = 0, alpha = 0.9) +
  theme_bw() +
  theme(legend.position = "none") # No legend
```


## Install R, RStudio and Packages

1.  Download and install the latest version of R <https://cran.r-project.org/bin/windows/base/>. Download the version for your operating system; R can be downloaded for Windows, Mac & Linux.\
2.  It is recommended R is used through the *RStudio* IDE. Download and install the latest version of RStudio from their web page <https://www.rstudio.com/products/rstudio/#Desktop>. Download the *free* desktop version.

### Install the *iBats* Package from GitHub

The `iBats` package contains example data and functions that help with the *Data Science* of bat survey results. To install this package use the code below in the console (see Figure ); *one line at a time*. The package is installed from GitHub.

```{r}
#| echo=FALSE,  
#| eval=FALSE


#Automatically write R package citation entries to a `.bib` file:

#knitr::write_bib(c(.packages(), 'knitr', 'shiny'), 'packages.bib')

knitr::write_bib(c('base',
                   'tidyverse',
                   'suncalc',
                   'ggplot2',
                   'dplyr',
                   'lubridate',
                   'stringr',
                   'broman',
                   'knitr',
                   'gt',
                   'readr',
                   'scales',
                   'readxl',
                   'mosaic',
                   'kableExtra',
                   'flextable'), 'packages.bib')

#Then add `bibliography: packages.bib` to the YAML frontmatter. Now you can cite packages. For example: the R language [@R-base] is awesome. We used the **knitr** package [@R-knitr; @knitr2015] in our analysis. We also build a Shiny app [@R-shiny].


# @Manual{,
#   title = {tidyr: Tidy Messy Data},
#   author = {Hadley Wickham and Maximilian Girlich},
#   year = {2022},
#   note = {https://tidyr.tidyverse.org, https://github.com/tidyverse/tidyr},
# }

```

```{r}
#| echo=TRUE, 
#| eval=FALSE

install.packages("devtools")

devtools::install_github("Nattereri/iBats")


```

## Acknowledgements

These web pages were built on the shoulders of others:

The visualisation and analysis has been undertaken in R [@R-base] using `r R.version.string`; R is an open-source statistical programming language.

This document has been produced dynamically using `knitr` [@R-knitr] and QUARTO, integrating the data, analysis and reporting. The analysis has undertaken a tidyverse approach [@tidyverse2019].

The graphics have been produced using the R package `ggplot2` [@R-ggplot2]. The `scales` [@R-scales] package improves the clarity of scales on `ggplot` graphics.

The wrangling of data was undertaken with `dplyr` [@R-dplyr] and `tidyr` packages. The data in *csv* and *Excel* files has been imported with `readr` [@R-readr] and `readxl` [@R-readxl] packages respectivily. The computation with dates and times has been accomplished with `lubridate` [@R-lubridate] package. Suntimes have been obtained with the `suncalc` [@R-suncalc] package.

The manipulation of text was through the `stringr` [@R-stringr] package. Summary statistics have been produced with the `mosaic` [@R-mosaic] package.

Tables have been produced with `knitr` [@R-knitr] with `kableExtra` [@R-kableExtra], `gt` [@R-knitr] and the `flextable` [@R-flextable] packages. The `broman` [@R-broman] package provided some useful R functions.

## References
